<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SRIAN-10 Koping Quiz</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f9f9;
      margin: 0;
      padding: 20px;
      color: #333;
    }
    .container {
      max-width: 700px;
      margin: auto;
      background: #fff;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    h1 {
      text-align: center;
      color: #2c7a7b;
    }
    .question {
      margin-bottom: 20px;
    }
    label { cursor: pointer; display:block; margin:6px 0; }
    button {
      background: #2c7a7b;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
    }
    button:hover {
      background: #225e5f;
    }
    .result {
      margin-top: 20px;
      padding: 15px;
      border-radius: 10px;
      background: #e6fffa;
      border: 1px solid #b2f5ea;
    }
    .progress {
      height: 20px;
      background: #e2e8f0;
      border-radius: 10px;
      overflow: hidden;
      margin-top: 10px;
    }
    .progress-bar {
      height: 100%;
      background: #2c7a7b;
      width: 0%;
      text-align: center;
      color: white;
      line-height: 20px;
      font-size: 12px;
    }
    .small { font-size:13px; color:#666; margin-top:8px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ðŸŒ¿ SRIAN-10 Koping Quiz</h1>
    <p><em>Cari tahu gaya Anda dalam menghadapi stres! (Alat refleksi, bukan diagnosis)</em></p>
    <form id="quizForm">
      <div id="questions"></div>
      <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
        <button type="button" id="scoreBtn">Lihat Hasil</button>
        <button type="button" id="resetBtn" style="background:#fff;color:#2c7a7b;border:1px solid #cfe6e5">Reset</button>
        <button type="button" id="saveBtn" style="background:#fff;color:#2c7a7b;border:1px solid #cfe6e5">Simpan Lokal</button>
        <button type="button" id="printBtn" style="background:#fff;color:#2c7a7b;border:1px solid #cfe6e5">Cetak / Simpan PDF</button>
      </div>
    </form>
    <div id="result" class="result" style="display:none;"></div>
    <div class="small">âœ¨ Catatan: Ini bukan alat diagnosis. Untuk dukungan kesehatan mental profesional, hubungi konselor/psikolog.</div>
  </div>

  <script>
    const questionsData = [
      "Ketika menghadapi masalah besar, sayaâ€¦",
      "Saat saya stres, saya biasanyaâ€¦",
      "Untuk menenangkan diri, sayaâ€¦",
      "Jika mengalami kegagalan, sayaâ€¦",
      "Saat menghadapi tekanan, sayaâ€¦",
      "Ketika mendapat kritik, sayaâ€¦",
      "Saat menghadapi konflik dengan orang lain, sayaâ€¦",
      "Jika merasa kewalahan dengan tugas, sayaâ€¦",
      "Ketika merasa cemas, sayaâ€¦",
      "Jika rencana tidak berjalan sesuai harapan, sayaâ€¦"
    ];

    const options = [
      ["A. Mencari solusi langkah demi langkah","B. Menunda, berharap masalah hilang sendiri","C. Marah atau frustrasi"],
      ["A. Bicara dengan teman/keluarga untuk dukungan","B. Menyalahkan diri sendiri","C. Menghindari orang lain"],
      ["A. Melakukan relaksasi, olahraga, atau aktivitas positif","B. Merokok/minum alkohol/menggunakan zat lain","C. Membiarkan rasa lelah terus berlarut"],
      ["A. Belajar dari pengalaman","B. Mengabaikan kegagalan seolah tidak terjadi","C. Menyalahkan diri sendiri"],
      ["A. Berfokus pada hal-hal positif","B. Menunda-nunda pekerjaan","C. Merasa tidak berdaya"],
      ["A. Menggunakannya untuk memperbaiki diri","B. Mengabaikan seolah tidak mendengar","C. Merasa sakit hati dan tersinggung"],
      ["A. Mencoba berdiskusi dengan tenang","B. Menghindar dan tidak membicarakannya","C. Meluapkan emosi atau marah"],
      ["A. Membuat daftar prioritas","B. Menunda sampai menit terakhir","C. Merasa putus asa"],
      ["A. Menggunakan teknik pernapasan/relaksasi","B. Mengabaikan rasa cemas","C. Menyalahkan diri sendiri atas kecemasan itu"],
      ["A. Mencari alternatif solusi","B. Berpura-pura tidak peduli","C. Menyalahkan keadaan atau orang lain"]
    ];

    // Generate questions
    const questionsDiv = document.getElementById("questions");
    questionsData.forEach((q, i) => {
      const div = document.createElement("div");
      div.classList.add("question");
      div.innerHTML = `<p><b>${i+1}. ${q}</b></p>` + 
        options[i].map((opt, j) => 
          `<label><input type="radio" name="q${i}" value="${String.fromCharCode(65+j)}"> ${opt}</label>`).join("");
      questionsDiv.appendChild(div);
    });

    function tally() {
      let counts = {A:0,B:0,C:0};
      for (let i = 0; i < questionsData.length; i++) {
        const sel = document.querySelector(`input[name="q${i}"]:checked`);
        if (sel) counts[sel.value] += 1;
      }
      return counts;
    }

    function interpret(counts) {
      const {A,B,C} = counts;
      // dominan
      let dominant;
      if (A>=B && A>=C) dominant = 'Strategi Koping Adaptif (Sehat)';
      else if (B>=A && B>=C) dominant = 'Strategi Koping Menghindar';
      else dominant = 'Strategi Koping Emosi Negatif';

      // total score: A=2, B=1, C=0 -> range 0-20
      const totalScore = A*2 + B*1 + C*0;
      let kategori;
      if (totalScore >= 16) kategori = 'Sangat Adaptif (16-20)';
      else if (totalScore >= 10) kategori = 'Cukup Adaptif (10-15)';
      else kategori = 'Perlu Perhatian (0-9)';

      return {dominant, totalScore, kategori, counts};
    }

    document.getElementById("scoreBtn").addEventListener("click", ()=> {
      // check answered
      let answered = 0;
      for (let i=0;i<questionsData.length;i++){
        if (document.querySelector(`input[name="q${i}"]:checked`)) answered++;
      }
      if (answered < questionsData.length) {
        if (!confirm('Beberapa pertanyaan belum dijawab. Lanjutkan nilai dengan jawaban yang ada?')) return;
      }
      const counts = tally();
      const res = interpret(counts);
      const scorePercent = Math.round((res.totalScore/20)*100);
      const progress = `<div class="progress"><div class="progress-bar" style="width:${scorePercent}%">${scorePercent}%</div></div>`;
      document.getElementById("result").style.display = "block";
      document.getElementById("result").innerHTML = `<strong>${res.dominant}</strong><p style="margin-top:8px">Skor total: ${res.totalScore} (0â€“20) â†’ <strong>${res.kategori}</strong></p>${progress}<hr><div class="small">Detail: A=${res.counts.A} â€¢ B=${res.counts.B} â€¢ C=${res.counts.C}</div>`;
    });

    document.getElementById("resetBtn").addEventListener("click", ()=> {
      if (!confirm('Reset semua jawaban?')) return;
      document.getElementById("quizForm").reset();
      document.getElementById("result").style.display = "none";
      document.getElementById("result").innerHTML = '';
    });

    document.getElementById("saveBtn").addEventListener("click", ()=> {
      const counts = tally();
      const res = interpret(counts);
      const record = {time: new Date().toISOString(), counts: res.counts, totalScore: res.totalScore, kategori: res.kategori};
      let arr = JSON.parse(localStorage.getItem('srian10_records') || '[]');
      arr.push(record);
      localStorage.setItem('srian10_records', JSON.stringify(arr));
      alert('Hasil disimpan secara lokal pada browser Anda. Data tidak dikirim ke server.');
    });

    document.getElementById("printBtn").addEventListener("click", ()=> window.print());
  </script>
</body>
</html>
